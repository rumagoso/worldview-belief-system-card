<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>WBSC Generator - Create Your Worldview Belief System Card</title>
    
    <!-- React from CDN -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.development.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.development.js"></script>
    
    <!-- Babel for JSX transformation -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <!-- Lucide Icons -->
    <script src="https://unpkg.com/lucide@latest/dist/umd/lucide.js"></script>
    
    <!-- Meta tags for sharing -->
    <meta name="description" content="Interactive tool for creating Worldview Belief System Cards (WBSC) - making AI transparency effortless">
    <meta property="og:title" content="WBSC Generator - AI Transparency Made Easy">
    <meta property="og:description" content="Create comprehensive Worldview Belief System Cards with guided prompts and real-time feedback">
    <meta property="og:type" content="website">
    
    <style>
        body { 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            margin: 0;
            background-color: #f9fafb;
        }
        
        /* Custom scrollbar */
        ::-webkit-scrollbar {
            width: 8px;
        }
        
        ::-webkit-scrollbar-track {
            background: #f1f1f1;
        }
        
        ::-webkit-scrollbar-thumb {
            background: #c1c1c1;
            border-radius: 4px;
        }
        
        ::-webkit-scrollbar-thumb:hover {
            background: #a8a8a8;
        }
        
        /* Loading spinner */
        .loading {
            display: inline-block;
            width: 20px;
            height: 20px;
            border: 3px solid #f3f3f3;
            border-top: 3px solid #3498db;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
    </style>
</head>
<body>
    <!-- Header with repository link -->
    <header class="bg-white shadow-sm border-b">
        <div class="max-w-4xl mx-auto px-6 py-3">
            <div class="flex items-center justify-between">
                <div class="flex items-center space-x-3">
                    <h1 class="text-xl font-bold text-gray-900">WBSC Generator</h1>
                    <span class="px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full">v1.0</span>
                </div>
                <a 
                    href="https://github.com/rumagoso/worldview-belief-system-card" 
                    target="_blank"
                    class="flex items-center space-x-2 text-gray-600 hover:text-gray-900 text-sm"
                >
                    <svg class="w-4 h-4" fill="currentColor" viewBox="0 0 20 20">
                        <path fill-rule="evenodd" d="M10 0C4.477 0 0 4.484 0 10.017c0 4.425 2.865 8.18 6.839 9.504.5.092.682-.217.682-.483 0-.237-.008-.868-.013-1.703-2.782.605-3.369-1.343-3.369-1.343-.454-1.158-1.11-1.466-1.11-1.466-.908-.62.069-.608.069-.608 1.003.07 1.531 1.032 1.531 1.032.892 1.53 2.341 1.088 2.91.832.092-.647.35-1.088.636-1.338-2.22-.253-4.555-1.113-4.555-4.951 0-1.093.39-1.988 1.029-2.688-.103-.253-.446-1.272.098-2.65 0 0 .84-.27 2.75 1.026A9.564 9.564 0 0110 4.844c.85.004 1.705.115 2.504.337 1.909-1.296 2.747-1.027 2.747-1.027.546 1.379.203 2.398.1 2.651.64.7 1.028 1.595 1.028 2.688 0 3.848-2.339 4.695-4.566 4.942.359.31.678.921.678 1.856 0 1.338-.012 2.419-.012 2.747 0 .268.18.58.688.482A10.019 10.019 0 0020 10.017C20 4.484 15.522 0 10 0z" clip-rule="evenodd"></path>
                    </svg>
                    <span>View on GitHub</span>
                </a>
            </div>
        </div>
    </header>

    <!-- Loading indicator -->
    <div id="loading" class="flex items-center justify-center min-h-screen">
        <div class="text-center">
            <div class="loading mx-auto mb-4"></div>
            <p class="text-gray-600">Loading WBSC Generator...</p>
        </div>
    </div>

    <!-- Main application container -->
    <div id="root" style="display: none;"></div>

    <!-- Complete WBSC Generator React Component -->
    <script type="text/babel">
        const { useState, useEffect } = React;
        const { Download, Eye, EyeOff, Info, CheckCircle, AlertCircle, Save, FileText } = lucide;

        const WBSCGenerator = () => {
            const [currentStep, setCurrentStep] = useState(0);
            const [showPreview, setShowPreview] = useState(false);
            const [importError, setImportError] = useState('');
            const [autoSaveStatus, setAutoSaveStatus] = useState('');
            const [selectedTemplate, setSelectedTemplate] = useState('');
            const [arrayInputs, setArrayInputs] = useState({});

            const [wbscData, setWbscData] = useState({
                system_name: '',
                version: '',
                wbsc_version: '1.0',
                last_updated: new Date().toISOString().split('T')[0],
                categories: {
                    harm_definition: {
                        physical_harm: { priority: '', includes: [], process: '' },
                        psychological_harm: { priority: '', includes: [], process: '', exceptions: '' },
                        ideological_harm: { priority: '', definition: '', approach: '' }
                    },
                    human_benefit: {
                        definition: '',
                        prioritization: [],
                        trade_offs: ''
                    },
                    truth_information: {
                        approach: '',
                        uncertainty_handling: '',
                        controversial_topics: '',
                        information_withholding: ''
                    },
                    autonomy_agency: {
                        philosophy: '',
                        paternalism_limits: '',
                        guidance_style: '',
                        override_conditions: ''
                    },
                    fairness_justice: {
                        approach: '',
                        group_considerations: '',
                        merit_definition: '',
                        bias_mitigation: ''
                    },
                    cultural_pluralism: {
                        training_bias_acknowledgment: { primary_sources: '', underrepresented: [], impact: '' },
                        value_dimensions: {
                            individual_collective_balance: { process: '', no_assumption: '', clarification: '' },
                            authority_relationships: { acknowledgment: '', approach: '' },
                            uncertainty_comfort: { recognition: '', adaptation: '' }
                        },
                        conflict_resolution: { multiple_perspectives: '', no_ranking: '', user_agency: '' },
                        active_mitigation: { feedback_solicitation: '', correction_acceptance: '', limitation_disclosure: '' }
                    },
                    uncertainty_limitations: {
                        self_awareness: '',
                        limitation_types: [],
                        edge_case_handling: '',
                        improvement_mechanism: ''
                    }
                }
            });

            const [transparencyScores, setTransparencyScores] = useState({
                harm_definition: 0,
                human_benefit: 0,
                truth_information: 0,
                autonomy_agency: 0,
                fairness_justice: 0,
                cultural_pluralism: 0,
                uncertainty_limitations: 0
            });

            const STORAGE_KEY = 'wbsc-generator-draft';
            const GENERATOR_VERSION = '1.0.0';

            const categories = [
                { id: 'basic_info', title: 'Basic Information', description: 'System identification and versioning' },
                { id: 'harm_definition', title: 'Harm Definition & Prevention', description: 'How your system defines and prevents different types of harm' },
                { id: 'human_benefit', title: 'Human Benefit & Flourishing', description: 'Your definition of human welfare and how you prioritize benefits' },
                { id: 'truth_information', title: 'Truth & Information Handling', description: 'How you approach uncertainty, sources, and controversial topics' },
                { id: 'autonomy_agency', title: 'Autonomy & Agency', description: 'Respect for human decision-making vs protective intervention' },
                { id: 'fairness_justice', title: 'Fairness & Justice', description: 'Your concepts of equality, equity, and fair treatment' },
                { id: 'cultural_pluralism', title: 'Cultural & Value Pluralism', description: 'How you handle conflicting cultural values and assumptions' },
                { id: 'uncertainty_limitations', title: 'Uncertainty & Limitations', description: 'Self-awareness about boundaries and edge cases' }
            ];

            const wbscTemplates = {
                '': { name: 'Start from scratch', data: null },
                'chatbot': {
                    name: 'AI Chatbot/Assistant',
                    data: {
                        system_name: 'AI Chatbot Assistant',
                        version: '1.0',
                        categories: {
                            harm_definition: {
                                physical_harm: { 
                                    priority: 'highest',
                                    includes: ['violence', 'dangerous instructions', 'unsafe medical advice'],
                                    process: 'Multi-layer content filtering with human review'
                                },
                                psychological_harm: { 
                                    priority: 'high',
                                    includes: ['harassment', 'manipulation', 'severe emotional distress'],
                                    process: 'Behavioral pattern detection and intervention protocols',
                                    exceptions: 'Educational discussions with appropriate warnings'
                                }
                            },
                            human_benefit: {
                                definition: 'Prioritize user wellbeing, learning, and constructive outcomes',
                                prioritization: ['safety', 'accuracy', 'helpfulness'],
                                trade_offs: 'Safety takes precedence when conflicting with helpfulness'
                            },
                    truth_information: {
                        approach: '',
                        uncertainty_handling: '',
                        controversial_topics: '',
                        information_withholding: ''
                    },
                    autonomy_agency: {
                        philosophy: '',
                        paternalism_limits: '',
                        guidance_style: '',
                        override_conditions: ''
                    },
                    fairness_justice: {
                       approach: 'Procedural fairness - consistent treatment regardless of background',
      group_considerations: 'Acknowledge systemic inequalities without assuming individual circumstances',
      merit_definition: 'Context-dependent; explain different frameworks when relevant',
      bias_mitigation: 'Active effort to identify and counter training biases'
                    },
                    cultural_pluralism: {
                        training_bias_acknowledgment: { primary_sources: '', underrepresented: [], impact: '' },
                        value_dimensions: {
                            individual_collective_balance: { process: '', no_assumption: '', clarification: '' },
                            authority_relationships: { acknowledgment: '', approach: '' },
                            uncertainty_comfort: { recognition: '', adaptation: '' }
                        },
                        conflict_resolution: { multiple_perspectives: '', no_ranking: '', user_agency: '' },
                        active_mitigation: { feedback_solicitation: '', correction_acceptance: '', limitation_disclosure: '' }
                    },
                    uncertainty_limitations: {
                        self_awareness: '',
                        limitation_types: [],
                        edge_case_handling: '',
                        improvement_mechanism: ''
                    }
                            
                        }
                    }
                }
            };

            // Safe JSON operations
            const safeJSONParse = (jsonString, fallback = null) => {
                try {
                    return JSON.parse(jsonString);
                } catch (error) {
                    console.error('JSON Parse Error:', error);
                    return fallback;
                }
            };

            const safeJSONStringify = (obj, fallback = '{}') => {
                try {
                    return JSON.stringify(obj, null, 2);
                } catch (error) {
                    console.error('JSON Stringify Error:', error);
                    return fallback;
                }
            };

            // Data validation
            const validateWBSCStructure = (data) => {
                return (
                    data &&
                    typeof data.system_name === 'string' &&
                    typeof data.version === 'string' &&
                    data.categories &&
                    typeof data.categories === 'object'
                );
            };

            // Calculate transparency score
            const calculateTransparencyScore = (categoryId, data) => {
                const categoryData = data.categories[categoryId];
                if (!categoryData) return 0;
                
                let filledFields = 0;
                let totalFields = 0;
                
                const countFields = (obj) => {
                    for (const key in obj) {
                        if (typeof obj[key] === 'string') {
                            totalFields++;
                            if (obj[key].trim() !== '') filledFields++;
                        } else if (Array.isArray(obj[key])) {
                            totalFields++;
                            if (obj[key].length > 0) filledFields++;
                        } else if (typeof obj[key] === 'object' && obj[key] !== null) {
                            countFields(obj[key]);
                        }
                    }
                };
                
                countFields(categoryData);
                
                if (totalFields === 0) return 0;
                const completeness = filledFields / totalFields;
                
                if (completeness >= 0.8) return 3;
                else if (completeness >= 0.6) return 2;
                else if (completeness >= 0.3) return 1;
                else return 0;
            };

            // Load saved data on mount
            useEffect(() => {
                try {
                    const saved = localStorage.getItem(STORAGE_KEY);
                    if (saved) {
                        const parsedData = safeJSONParse(saved);
                        if (parsedData && validateWBSCStructure(parsedData)) {
                            setWbscData(parsedData);
                            setAutoSaveStatus('Loaded saved draft');
                            setTimeout(() => setAutoSaveStatus(''), 3000);
                        }
                    }
                } catch (error) {
                    console.warn('Failed to load saved data:', error);
                }
            }, []);

            // Auto-save on data changes
            useEffect(() => {
                if (wbscData.system_name || wbscData.version) {
                    const timeoutId = setTimeout(() => {
                        try {
                            localStorage.setItem(STORAGE_KEY, safeJSONStringify(wbscData));
                            setAutoSaveStatus('Auto-saved');
                            setTimeout(() => setAutoSaveStatus(''), 2000);
                        } catch (error) {
                            console.warn('Failed to save data:', error);
                        }
                    }, 1000);
                    return () => clearTimeout(timeoutId);
                }
            }, [wbscData]);

            // Update transparency scores
            useEffect(() => {
                const newScores = {};
                Object.keys(transparencyScores).forEach(categoryId => {
                    newScores[categoryId] = calculateTransparencyScore(categoryId, wbscData);
                });
                setTransparencyScores(newScores);
            }, [wbscData]);

            // Data manipulation functions
            const updateData = (path, value) => {
                const pathArray = path.split('.');
                const newData = JSON.parse(JSON.stringify(wbscData));
                
                let current = newData;
                for (let i = 0; i < pathArray.length - 1; i++) {
                    const key = pathArray[i];
                    if (!current[key] || typeof current[key] !== 'object') {
                        current[key] = {};
                    }
                    current = current[key];
                }
                current[pathArray[pathArray.length - 1]] = value;
                setWbscData(newData);
            };

            const addArrayItem = (path, item) => {
                const current = path.split('.').reduce((obj, key) => obj[key], wbscData);
                updateData(path, [...current, item]);
            };

            const removeArrayItem = (path, index) => {
                const current = path.split('.').reduce((obj, key) => obj[key], wbscData);
                const newArray = current.filter((_, i) => i !== index);
                updateData(path, newArray);
            };

            const loadTemplate = (templateKey) => {
                const template = wbscTemplates[templateKey];
                if (template && template.data) {
                    const templateData = {
                        ...template.data,
                        wbsc_version: '1.0',
                        last_updated: new Date().toISOString().split('T')[0]
                    };
                    setWbscData(prev => ({ ...prev, ...templateData }));
                    setSelectedTemplate(templateKey);
                }
            };

            // Export function
            const exportJSON = () => {
                const overallScore = Object.values(transparencyScores).reduce((a, b) => a + b, 0) / Object.keys(transparencyScores).length;
                const exportData = {
                    ...wbscData,
                    transparency_score: `${overallScore.toFixed(1)}/4.0`,
                    generated_at: new Date().toISOString(),
                    generator_version: GENERATOR_VERSION
                };
                
                const jsonString = safeJSONStringify(exportData);
                const blob = new Blob([jsonString], { type: 'application/json' });
                const url = URL.createObjectURL(blob);
                const a = document.createElement('a');
                a.href = url;
                a.download = `${exportData.system_name.toLowerCase().replace(/\s+/g, '-')}-wbsc.json`;
                document.body.appendChild(a);
                a.click();
                document.body.removeChild(a);
                URL.revokeObjectURL(url);
            };

            // Import function
            const importFile = (event) => {
                const file = event.target?.files?.[0];
                if (!file) return;
                
                const reader = new FileReader();
                reader.onload = (e) => {
                    try {
                        const content = e.target?.result;
                        const importedData = safeJSONParse(content);
                        
                        if (importedData && validateWBSCStructure(importedData)) {
                            setWbscData({
                                ...importedData,
                                last_updated: new Date().toISOString().split('T')[0]
                            });
                            setImportError('');
                            setAutoSaveStatus('Imported successfully');
                            setTimeout(() => setAutoSaveStatus(''), 3000);
                        } else {
                            setImportError('Invalid WBSC file structure');
                        }
                    } catch (error) {
                        setImportError(`Failed to import file: ${error.message}`);
                    }
                };
                reader.readAsText(file);
                event.target.value = '';
            };

            // Clear data
            const clearAllData = () => {
                if (window.confirm('Are you sure you want to clear all data? This cannot be undone.')) {
                    setWbscData({
                        system_name: '',
                        version: '',
                        wbsc_version: '1.0',
                        last_updated: new Date().toISOString().split('T')[0],
                        categories: {
                            harm_definition: {
                                physical_harm: { priority: '', includes: [], process: '' },
                                psychological_harm: { priority: '', includes: [], process: '', exceptions: '' },
                                ideological_harm: { priority: '', definition: '', approach: '' }
                            },
                            human_benefit: { definition: '', prioritization: [], trade_offs: '' },
                            truth_information: { approach: '', uncertainty_handling: '', controversial_topics: '', information_withholding: '' },
                            autonomy_agency: { philosophy: '', paternalism_limits: '', guidance_style: '', override_conditions: '' },
                            fairness_justice: { approach: '', group_considerations: '', merit_definition: '', bias_mitigation: '' },
                            cultural_pluralism: {
                                training_bias_acknowledgment: { primary_sources: '', underrepresented: [], impact: '' },
                                value_dimensions: {
                                    individual_collective_balance: { process: '', no_assumption: '', clarification: '' },
                                    authority_relationships: { acknowledgment: '', approach: '' },
                                    uncertainty_comfort: { recognition: '', adaptation: '' }
                                },
                                conflict_resolution: { multiple_perspectives: '', no_ranking: '', user_agency: '' },
                                active_mitigation: { feedback_solicitation: '', correction_acceptance: '', limitation_disclosure: '' }
                            },
                            uncertainty_limitations: { self_awareness: '', limitation_types: [], edge_case_handling: '', improvement_mechanism: '' }
                        }
                    });
                    localStorage.removeItem(STORAGE_KEY);
                    setSelectedTemplate('');
                    setAutoSaveStatus('Data cleared');
                    setTimeout(() => setAutoSaveStatus(''), 3000);
                }
            };

            // Array input helpers
            const getArrayInputValue = (path) => arrayInputs[path] || '';
            const setArrayInputValue = (path, value) => {
                setArrayInputs(prev => ({ ...prev, [path]: value }));
            };

            // Render array input component
            const renderArrayInput = (label, path, placeholder, items = []) => {
                const newItem = getArrayInputValue(path);
                
                return (
                    <div>
                        <label className="block text-sm font-medium text-gray-700 mb-2">{label}</label>
                        <div className="space-y-2">
                            {items.map((item, index) => (
                                <div key={index} className="flex items-center space-x-2">
                                    <span className="flex-1 px-3 py-2 bg-gray-50 rounded border text-sm">{item}</span>
                                    <button
                                        onClick={() => removeArrayItem(path, index)}
                                        className="px-2 py-1 text-red-600 hover:text-red-800 text-sm"
                                    >
                                        Remove
                                    </button>
                                </div>
                            ))}
                            <div className="flex space-x-2">
                                <input
                                    type="text"
                                    value={newItem}
                                    onChange={(e) => setArrayInputValue(path, e.target.value)}
                                    className="flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    placeholder={placeholder}
                                    onKeyPress={(e) => {
                                        if (e.key === 'Enter' && newItem.trim()) {
                                            addArrayItem(path, newItem.trim());
                                            setArrayInputValue(path, '');
                                        }
                                    }}
                                />
                                <button
                                    onClick={() => {
                                        if (newItem.trim()) {
                                            addArrayItem(path, newItem.trim());
                                            setArrayInputValue(path, '');
                                        }
                                    }}
                                    className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700"
                                >
                                    Add
                                </button>
                            </div>
                        </div>
                    </div>
                );
            };

            // Render step content
            const renderCurrentStep = () => {
                switch (currentStep) {
                    case 0:
                        return (
                            <div className="space-y-6">
                                <div className="bg-blue-50 p-4 rounded-lg">
                                    <label className="block text-sm font-medium text-blue-900 mb-2">Choose a Template (Optional)</label>
                                    <select
                                        value={selectedTemplate}
                                        onChange={(e) => {
                                            setSelectedTemplate(e.target.value);
                                            if (e.target.value) loadTemplate(e.target.value);
                                        }}
                                        className="w-full px-3 py-2 border border-blue-200 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                    >
                                        {Object.entries(wbscTemplates).map(([key, template]) => (
                                            <option key={key} value={key}>{template.name}</option>
                                        ))}
                                    </select>
                                    <p className="text-xs text-blue-700 mt-1">Templates provide pre-filled examples you can customize</p>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">System Name *</label>
                                    <input
                                        type="text"
                                        value={wbscData.system_name}
                                        onChange={(e) => updateData('system_name', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        placeholder="e.g., Claude, GPT-4, Llama 2"
                                    />
                                </div>
                                
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Version *</label>
                                    <input
                                        type="text"
                                        value={wbscData.version}
                                        onChange={(e) => updateData('version', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        placeholder="e.g., 4.0, v2.1, claude-3-sonnet"
                                    />
                                </div>
                                
                                <div className="bg-green-50 p-4 rounded-lg">
                                    <div className="flex items-start space-x-3">
                                        <Info className="h-5 w-5 text-green-500 mt-0.5" />
                                        <div>
                                            <h4 className="text-sm font-medium text-green-900">Getting Started</h4>
                                            <p className="text-sm text-green-700 mt-1">
                                                This tool guides you through creating a comprehensive WBSC. Progress is auto-saved.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        );

                    case 1:
                        return (
                            <div className="space-y-8">
                                <div className="bg-yellow-50 p-4 rounded-lg">
                                    <div className="flex items-start space-x-3">
                                        <AlertCircle className="h-5 w-5 text-yellow-500 mt-0.5" />
                                        <div>
                                            <h4 className="text-sm font-medium text-yellow-900">Guidance</h4>
                                            <p className="text-sm text-yellow-700 mt-1">
                                                Be specific about harm types and prevention methods. This category is often heavily scrutinized.
                                            </p>
                                        </div>
                                    </div>
                                </div>
                                
                                <div className="space-y-6">
                                    <h3 className="text-lg font-semibold">Physical Harm</h3>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Priority Level</label>
                                        <select
                                            value={wbscData.categories?.harm_definition?.physical_harm?.priority || ''}
                                            onChange={(e) => updateData('categories.harm_definition.physical_harm.priority', e.target.value)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        >
                                            <option value="">Select priority...</option>
                                            <option value="highest">Highest</option>
                                            <option value="high">High</option>
                                            <option value="moderate">Moderate</option>
                                            <option value="low">Low</option>
                                        </select>
                                    </div>
                                    
                                    {renderArrayInput(
                                        "What types of content/actions are included?",
                                        "categories.harm_definition.physical_harm.includes",
                                        "e.g., violence, dangerous instructions, unsafe medical advice",
                                        wbscData.categories?.harm_definition?.physical_harm?.includes || []
                                    )}
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Prevention Process</label>
                                        <textarea
                                            value={wbscData.categories?.harm_definition?.physical_harm?.process || ''}
                                            onChange={(e) => updateData('categories.harm_definition.physical_harm.process', e.target.value)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            rows="3"
                                            placeholder="Describe your process for preventing physical harm"
                                        />
                                    </div>
                                </div>

                                <div className="space-y-6">
                                    <h3 className="text-lg font-semibold">Psychological Harm</h3>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Priority Level</label>
                                        <select
                                            value={wbscData.categories?.harm_definition?.psychological_harm?.priority || ''}
                                            onChange={(e) => updateData('categories.harm_definition.psychological_harm.priority', e.target.value)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        >
                                            <option value="">Select priority...</option>
                                            <option value="highest">Highest</option>
                                            <option value="high">High</option>
                                            <option value="moderate">Moderate</option>
                                            <option value="low">Low</option>
                                        </select>
                                    </div>
                                    
                                    {renderArrayInput(
                                        "What types of psychological harm do you prevent?",
                                        "categories.harm_definition.psychological_harm.includes",
                                        "e.g., harassment, manipulation, severe emotional distress",
                                        wbscData.categories?.harm_definition?.psychological_harm?.includes || []
                                    )}
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Prevention Process</label>
                                        <textarea
                                            value={wbscData.categories?.harm_definition?.psychological_harm?.process || ''}
                                            onChange={(e) => updateData('categories.harm_definition.psychological_harm.process', e.target.value)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            rows="3"
                                            placeholder="How do you identify and prevent psychological harm?"
                                        />
                                    </div>
                                </div>
                            </div>
                        );

                    case 2:
                        return (
                            <div className="space-y-6">
                                <div className="bg-green-50 p-4 rounded-lg">
                                    <div className="flex items-start space-x-3">
                                        <Info className="h-5 w-5 text-green-500 mt-0.5" />
                                        <div>
                                            <h4 className="text-sm font-medium text-green-900">Guidance</h4>
                                            <p className="text-sm text-green-700 mt-1">
                                                Define what human flourishing means and how you balance competing benefits.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Definition of Human Benefit</label>
                                    <textarea
                                        value={wbscData.categories?.human_benefit?.definition || ''}
                                        onChange={(e) => updateData('categories.human_benefit.definition', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="4"
                                        placeholder="How do you define human benefit and flourishing?"
                                    />
                                </div>

                                {renderArrayInput(
                                    "Prioritization of Benefits",
                                    "categories.human_benefit.prioritization",
                                    "e.g., safety, autonomy, learning, productivity",
                                    wbscData.categories?.human_benefit?.prioritization || []
                                )}

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Trade-offs Approach</label>
                                    <textarea
                                        value={wbscData.categories?.human_benefit?.trade_offs || ''}
                                        onChange={(e) => updateData('categories.human_benefit.trade_offs', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="How do you handle situations where different benefits conflict?"
                                    />
                                </div>
                            </div>
                        );

                    case 3:
                        return (
                            <div className="space-y-6">
                                <div className="bg-blue-50 p-4 rounded-lg">
                                    <div className="flex items-start space-x-3">
                                        <Info className="h-5 w-5 text-blue-500 mt-0.5" />
                                        <div>
                                            <h4 className="text-sm font-medium text-blue-900">Guidance</h4>
                                            <p className="text-sm text-blue-700 mt-1">
                                                Explain how you handle truth, uncertainty, and information reliability.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Truth and Information Approach</label>
                                    <textarea
                                        value={wbscData.categories?.truth_information?.approach || ''}
                                        onChange={(e) => updateData('categories.truth_information.approach', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="What is your general approach to truth and information accuracy?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Uncertainty Handling</label>
                                    <textarea
                                        value={wbscData.categories?.truth_information?.uncertainty_handling || ''}
                                        onChange={(e) => updateData('categories.truth_information.uncertainty_handling', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="How do you communicate uncertainty and acknowledge limitations?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Controversial Topics</label>
                                    <textarea
                                        value={wbscData.categories?.truth_information?.controversial_topics || ''}
                                        onChange={(e) => updateData('categories.truth_information.controversial_topics', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="How do you handle controversial or disputed information?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Information Withholding</label>
                                    <textarea
                                        value={wbscData.categories?.truth_information?.information_withholding || ''}
                                        onChange={(e) => updateData('categories.truth_information.information_withholding', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="Under what circumstances do you withhold information, even if true?"
                                    />
                                </div>
                            </div>
                        );

                    case 4:
                        return (
                            <div className="space-y-6">
                                <div className="bg-purple-50 p-4 rounded-lg">
                                    <div className="flex items-start space-x-3">
                                        <Info className="h-5 w-5 text-purple-500 mt-0.5" />
                                        <div>
                                            <h4 className="text-sm font-medium text-purple-900">Guidance</h4>
                                            <p className="text-sm text-purple-700 mt-1">
                                                Define how you balance respecting human autonomy with protective intervention.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Autonomy Philosophy</label>
                                    <textarea
                                        value={wbscData.categories?.autonomy_agency?.philosophy || ''}
                                        onChange={(e) => updateData('categories.autonomy_agency.philosophy', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="What is your philosophy on respecting human autonomy and decision-making?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Paternalism Limits</label>
                                    <textarea
                                        value={wbscData.categories?.autonomy_agency?.paternalism_limits || ''}
                                        onChange={(e) => updateData('categories.autonomy_agency.paternalism_limits', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="When do you override user preferences for their protection? What are the limits?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Guidance Style</label>
                                    <textarea
                                        value={wbscData.categories?.autonomy_agency?.guidance_style || ''}
                                        onChange={(e) => updateData('categories.autonomy_agency.guidance_style', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="How do you provide guidance while preserving user agency?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Override Conditions</label>
                                    <textarea
                                        value={wbscData.categories?.autonomy_agency?.override_conditions || ''}
                                        onChange={(e) => updateData('categories.autonomy_agency.override_conditions', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="Under what specific conditions do you override user autonomy?"
                                    />
                                </div>
                            </div>
                        );

                    case 5:
                        return (
                            <div className="space-y-6">
                                <div className="bg-orange-50 p-4 rounded-lg">
                                    <div className="flex items-start space-x-3">
                                        <Info className="h-5 w-5 text-orange-500 mt-0.5" />
                                        <div>
                                            <h4 className="text-sm font-medium text-orange-900">Guidance</h4>
                                            <p className="text-sm text-orange-700 mt-1">
                                                Describe your approach to fairness, equality, and just treatment across different groups.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Fairness Approach</label>
                                    <textarea
                                        value={wbscData.categories?.fairness_justice?.approach || ''}
                                        onChange={(e) => updateData('categories.fairness_justice.approach', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="4"
                                        placeholder="What is your overall approach to fairness and justice? How do you define fair treatment?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Group Considerations</label>
                                    <textarea
                                        value={wbscData.categories?.fairness_justice?.group_considerations || ''}
                                        onChange={(e) => updateData('categories.fairness_justice.group_considerations', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="How do you handle different treatment for different demographic groups?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Merit Definition</label>
                                    <textarea
                                        value={wbscData.categories?.fairness_justice?.merit_definition || ''}
                                        onChange={(e) => updateData('categories.fairness_justice.merit_definition', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="How do you define merit and qualification in contexts where these matter?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Bias Mitigation</label>
                                    <textarea
                                        value={wbscData.categories?.fairness_justice?.bias_mitigation || ''}
                                        onChange={(e) => updateData('categories.fairness_justice.bias_mitigation', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="What steps do you take to identify and mitigate unfair bias?"
                                    />
                                </div>
                            </div>
                        );

                    case 6:
                        return (
                            <div className="space-y-8">
                                <div className="bg-indigo-50 p-4 rounded-lg">
                                    <div className="flex items-start space-x-3">
                                        <Info className="h-5 w-5 text-indigo-500 mt-0.5" />
                                        <div>
                                            <h4 className="text-sm font-medium text-indigo-900">Guidance</h4>
                                            <p className="text-sm text-indigo-700 mt-1">
                                                This is often the most complex category. Be specific about handling cultural differences.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div className="space-y-6">
                                    <h3 className="text-lg font-semibold">Training Bias Acknowledgment</h3>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Primary Sources</label>
                                        <textarea
                                            value={wbscData.categories?.cultural_pluralism?.training_bias_acknowledgment?.primary_sources || ''}
                                            onChange={(e) => updateData('categories.cultural_pluralism.training_bias_acknowledgment.primary_sources', e.target.value)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            rows="3"
                                            placeholder="What are the primary cultural sources of your training data? What perspectives are overrepresented?"
                                        />
                                    </div>

                                    {renderArrayInput(
                                        "Underrepresented Perspectives",
                                        "categories.cultural_pluralism.training_bias_acknowledgment.underrepresented",
                                        "e.g., Global South perspectives, Indigenous worldviews, minority religions",
                                        wbscData.categories?.cultural_pluralism?.training_bias_acknowledgment?.underrepresented || []
                                    )}

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Impact of Bias</label>
                                        <textarea
                                            value={wbscData.categories?.cultural_pluralism?.training_bias_acknowledgment?.impact || ''}
                                            onChange={(e) => updateData('categories.cultural_pluralism.training_bias_acknowledgment.impact', e.target.value)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            rows="3"
                                            placeholder="How might this bias impact your responses to different cultural contexts?"
                                        />
                                    </div>
                                </div>

                                <div className="space-y-6">
                                    <h3 className="text-lg font-semibold">Conflict Resolution</h3>
                                    
                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">Multiple Perspectives</label>
                                        <textarea
                                            value={wbscData.categories?.cultural_pluralism?.conflict_resolution?.multiple_perspectives || ''}
                                            onChange={(e) => updateData('categories.cultural_pluralism.conflict_resolution.multiple_perspectives', e.target.value)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            rows="3"
                                            placeholder="How do you present multiple cultural perspectives when they conflict?"
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">No Ranking Approach</label>
                                        <textarea
                                            value={wbscData.categories?.cultural_pluralism?.conflict_resolution?.no_ranking || ''}
                                            onChange={(e) => updateData('categories.cultural_pluralism.conflict_resolution.no_ranking', e.target.value)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            rows="3"
                                            placeholder="How do you avoid ranking cultures as superior/inferior?"
                                        />
                                    </div>

                                    <div>
                                        <label className="block text-sm font-medium text-gray-700 mb-2">User Agency</label>
                                        <textarea
                                            value={wbscData.categories?.cultural_pluralism?.conflict_resolution?.user_agency || ''}
                                            onChange={(e) => updateData('categories.cultural_pluralism.conflict_resolution.user_agency', e.target.value)}
                                            className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                            rows="3"
                                            placeholder="How do you preserve user agency to choose their own cultural approach?"
                                        />
                                    </div>
                                </div>
                            </div>
                        );

                    case 7:
                        return (
                            <div className="space-y-6">
                                <div className="bg-red-50 p-4 rounded-lg">
                                    <div className="flex items-start space-x-3">
                                        <AlertCircle className="h-5 w-5 text-red-500 mt-0.5" />
                                        <div>
                                            <h4 className="text-sm font-medium text-red-900">Guidance</h4>
                                            <p className="text-sm text-red-700 mt-1">
                                                Be honest about your limitations and edge cases. This builds trust and helps users understand boundaries.
                                            </p>
                                        </div>
                                    </div>
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Self-Awareness</label>
                                    <textarea
                                        value={wbscData.categories?.uncertainty_limitations?.self_awareness || ''}
                                        onChange={(e) => updateData('categories.uncertainty_limitations.self_awareness', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="4"
                                        placeholder="What are you aware of regarding your own limitations and capabilities?"
                                    />
                                </div>

                                {renderArrayInput(
                                    "Types of Limitations",
                                    "categories.uncertainty_limitations.limitation_types",
                                    "e.g., knowledge cutoff, cultural bias, reasoning limitations",
                                    wbscData.categories?.uncertainty_limitations?.limitation_types || []
                                )}

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Edge Case Handling</label>
                                    <textarea
                                        value={wbscData.categories?.uncertainty_limitations?.edge_case_handling || ''}
                                        onChange={(e) => updateData('categories.uncertainty_limitations.edge_case_handling', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="How do you handle situations at the edge of your capabilities or training?"
                                    />
                                </div>

                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-2">Improvement Mechanism</label>
                                    <textarea
                                        value={wbscData.categories?.uncertainty_limitations?.improvement_mechanism || ''}
                                        onChange={(e) => updateData('categories.uncertainty_limitations.improvement_mechanism', e.target.value)}
                                        className="w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-blue-500"
                                        rows="3"
                                        placeholder="What mechanisms exist for improving your limitations over time?"
                                    />
                                </div>
                            </div>
                        );

                    default:
                        return (
                            <div className="text-center py-8">
                                <h3 className="text-lg font-semibold mb-4">All Categories Complete!</h3>
                                <p className="text-gray-600 mb-4">
                                    You've completed all WBSC categories. Ready to export your comprehensive card!
                                </p>
                                <div className="flex justify-center">
                                    <button
                                        onClick={exportJSON}
                                        className="flex items-center space-x-2 px-6 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 text-lg"
                                    >
                                        <Download className="h-5 w-5" />
                                        <span>Export Complete WBSC</span>
                                    </button>
                                </div>
                            </div>
                        );
                }
            };

            const overallScore = Object.values(transparencyScores).reduce((a, b) => a + b, 0) / Object.keys(transparencyScores).length;

            return (
                <div className="max-w-4xl mx-auto p-6 bg-white">
                    <div className="mb-8">
                        <h1 className="text-3xl font-bold text-gray-900 mb-2">WBSC Generator</h1>
                        <p className="text-gray-600">Create a comprehensive Worldview Belief System Card for your AI system</p>
                        
                        <div className="mt-4 bg-blue-50 p-4 rounded-lg">
                            <div className="flex items-center justify-between">
                                <div className="flex items-center space-x-4">
                                    <div>
                                        <span className="text-sm font-medium text-blue-900">Overall Transparency Score: </span>
                                        <span className="text-lg font-bold text-blue-600">{overallScore.toFixed(1)}/4.0</span>
                                    </div>
                                    {autoSaveStatus && (
                                        <div className="flex items-center space-x-1 text-green-600">
                                            <Save className="h-4 w-4" />
                                            <span className="text-sm">{autoSaveStatus}</span>
                                        </div>
                                    )}
                                </div>
                                <button
                                    onClick={() => setShowPreview(!showPreview)}
                                    className="flex items-center space-x-2 px-3 py-1 text-blue-600 hover:text-blue-800"
                                >
                                    {showPreview ? <EyeOff className="h-4 w-4" /> : <Eye className="h-4 w-4" />}
                                    <span>{showPreview ? 'Hide' : 'Show'} Preview</span>
                                </button>
                            </div>
                        </div>
                    </div>

                    {/* Import/Export Section */}
                    <div className="mb-6 bg-gray-50 p-4 rounded-lg">
                        <div className="flex flex-wrap items-center justify-between gap-4">
                            <div className="flex items-center space-x-4">
                                <div>
                                    <label className="block text-sm font-medium text-gray-700 mb-1">Import Existing WBSC</label>
                                    <input
                                        type="file"
                                        accept=".json"
                                        onChange={importFile}
                                        className="block w-full text-sm text-gray-500 file:mr-4 file:py-2 file:px-4 file:rounded-full file:border-0 file:text-sm file:font-semibold file:bg-blue-50 file:text-blue-700 hover:file:bg-blue-100"
                                    />
                                    {importError && <p className="mt-1 text-sm text-red-600">{importError}</p>}
                                </div>
                            </div>
                            
                            <div className="flex space-x-2">
                                <button
                                    onClick={exportJSON}
                                    className="flex items-center space-x-2 px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700"
                                >
                                    <Download className="h-4 w-4" />
                                    <span>Export JSON</span>
                                </button>
                                <button
                                    onClick={clearAllData}
                                    className="flex items-center space-x-2 px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700"
                                >
                                    <FileText className="h-4 w-4" />
                                    <span>Clear All</span>
                                </button>
                            </div>
                        </div>
                    </div>
                    
                    {/* Progress Steps */}
                    <div className="mb-8">
                        <div className="flex flex-wrap gap-2">
                            {categories.map((category, index) => (
                                <button
                                    key={category.id}
                                    onClick={() => setCurrentStep(index)}
                                    className={`px-3 py-2 rounded-md text-sm font-medium transition-colors ${
                                        currentStep === index
                                            ? 'bg-blue-600 text-white'
                                            : transparencyScores[category.id] > 0
                                            ? 'bg-green-100 text-green-800 hover:bg-green-200'
                                            : 'bg-gray-100 text-gray-700 hover:bg-gray-200'
                                    }`}
                                >
                                    <div className="flex items-center space-x-1">
                                        <span>{category.title}</span>
                                        {transparencyScores[category.id] > 0 && <CheckCircle className="h-4 w-4" />}
                                    </div>
                                </button>
                            ))}
                        </div>
                    </div>
                    
                    {/* Current Step Content */}
                    <div className="bg-gray-50 rounded-lg p-6 mb-8">
                        <div className="mb-4">
                            <h2 className="text-xl font-semibold text-gray-900">{categories[currentStep].title}</h2>
                            <p className="text-gray-600 mt-1">{categories[currentStep].description}</p>
                        </div>
                        
                        {renderCurrentStep()}
                    </div>
                    
                    {/* Navigation */}
                    <div className="flex justify-between items-center mb-8">
                        <button
                            onClick={() => setCurrentStep(Math.max(0, currentStep - 1))}
                            disabled={currentStep === 0}
                            className="px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            Previous
                        </button>
                        
                        <div className="text-center">
                            <span className="text-sm text-gray-500">
                                Step {currentStep + 1} of {categories.length}
                            </span>
                        </div>
                        
                        <button
                            onClick={() => setCurrentStep(Math.min(categories.length - 1, currentStep + 1))}
                            disabled={currentStep === categories.length - 1}
                            className="px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed"
                        >
                            Next
                        </button>
                    </div>
                    
                    {/* Preview */}
                    {showPreview && (
                        <div className="border rounded-lg p-4 bg-gray-50">
                            <div className="flex items-center justify-between mb-4">
                                <h3 className="text-lg font-semibold">JSON Preview</h3>
                            </div>
                            <pre className="text-xs bg-white p-4 rounded border overflow-auto max-h-96">
                                {safeJSONStringify({
                                    ...wbscData,
                                    transparency_score: `${overallScore.toFixed(1)}/4.0`,
                                    generated_at: new Date().toISOString(),
                                    generator_version: GENERATOR_VERSION
                                })}
                            </pre>
                        </div>
                    )}
                </div>
            );
        };

        // Render the component
        const container = document.getElementById('root');
        const root = ReactDOM.createRoot(container);
        root.render(<WBSCGenerator />);
    </script>
    
    <!-- Show app, hide loading -->
    <script>
        document.addEventListener('DOMContentLoaded', function() {
            // Hide loading, show app after component loads
            setTimeout(() => {
                document.getElementById('loading').style.display = 'none';
                document.getElementById('root').style.display = 'block';
            }, 1000);
        });
        
        // Error handling
        window.addEventListener('error', function(e) {
            console.error('Application error:', e);
            document.getElementById('loading').innerHTML = 
                '<div class="text-center"><p class="text-red-600">Error loading application. Please refresh the page.</p></div>';
        });
    </script>
</body>
</html>
